{"ast":null,"code":"import axios from\"axios\";import Cookie from\"js-cookie\";axios.interceptors.request.use(function(response){response.headers.common[\"Authorization\"]=Cookie.get(\"accesstoken\")+\"\";return response;},function(error){});axios.interceptors.response.use(function(response){return response;},function(error){var originalRequest=error.config;if(error.response.status===401&&originalRequest.url===\"https://hamnavazi-api.azurewebsites.net/api/Account/RefreshToken\"){window.location.href=\"/Auth/Login\";return Promise.reject(error);}if(error.response.status===401&&!originalRequest._retry){originalRequest._retry=true;// const refreshToken = Cookie.get(\"refreshtoken\")\nvar refreshToken=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJmNDhiOTYxOC1jZGY1LTEyNDktNTY4Ni0xYjNhMTA2NzlkYjgiLCJpc3MiOiJodHRwczovL3BvcnRhbC5xZWF0ZWNoLmNvbS8iLCJpYXQiOjE2MDI2Njg2MjksImh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd3MvMjAwOC8wNi9pZGVudGl0eS9jbGFpbXMvc2VyaWFsbnVtYmVyIjoiOTZlNTkxNWM4NzliN2VlMTU0ZjQ5Njg2NjQ5ZGQ1NzkiLCJuYmYiOjE2MDI2Njg2MjksImV4cCI6MTYwMjY5MDIyOSwiYXVkIjoiQW55In0.SVhosgAjsA3Iql7qjWUFTJ0s30pmVd3RrqikddIh004\";axios.defaults.headers.common[\"refreshToken\"]=refreshToken+\"\";return axios.post(\"https://hamnavazi-api.azurewebsites.net/api/Account/RefreshToken\").then(function(res){if(res.status===200){Cookie.set(\"accesstoken\",res.headers.accesstoken);error.config.headers.Authorization=res.headers.accesstoken;return axios(originalRequest);}});}return Promise.reject(error);});export default{get:axios.get,post:axios.post,delete:axios.delete,put:axios.put};","map":{"version":3,"sources":["/home/ali/reactjs-startup-accompaniment/src/core/api/http.api.ts"],"names":["axios","Cookie","interceptors","request","use","response","headers","common","get","error","originalRequest","config","status","url","window","location","href","Promise","reject","_retry","refreshToken","defaults","post","then","res","set","accesstoken","Authorization","delete","put"],"mappings":"AAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,WAAnB,CAEAD,KAAK,CAACE,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CACE,SAACC,QAAD,CAAc,CACZA,QAAQ,CAACC,OAAT,CAAiBC,MAAjB,CAAwB,eAAxB,EAA2CN,MAAM,CAACO,GAAP,CAAW,aAAX,EAA4B,EAAvE,CACA,MAAOH,CAAAA,QAAP,CACD,CAJH,CAKE,SAAUI,KAAV,CAAiB,CAAE,CALrB,EAQAT,KAAK,CAACE,YAAN,CAAmBG,QAAnB,CAA4BD,GAA5B,CACE,SAACC,QAAD,CAAc,CACZ,MAAOA,CAAAA,QAAP,CACD,CAHH,CAIE,SAAUI,KAAV,CAAiB,CACf,GAAMC,CAAAA,eAAe,CAAGD,KAAK,CAACE,MAA9B,CAEA,GACEF,KAAK,CAACJ,QAAN,CAAeO,MAAf,GAA0B,GAA1B,EACAF,eAAe,CAACG,GAAhB,GACE,kEAHJ,CAIE,CACAC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAuB,aAAvB,CACA,MAAOC,CAAAA,OAAO,CAACC,MAAR,CAAeT,KAAf,CAAP,CACD,CAED,GAAIA,KAAK,CAACJ,QAAN,CAAeO,MAAf,GAA0B,GAA1B,EAAiC,CAACF,eAAe,CAACS,MAAtD,CAA8D,CAC5DT,eAAe,CAACS,MAAhB,CAAyB,IAAzB,CACA;AACA,GAAMC,CAAAA,YAAY,CAChB,kaADF,CAEApB,KAAK,CAACqB,QAAN,CAAef,OAAf,CAAuBC,MAAvB,CAA8B,cAA9B,EAAgDa,YAAY,CAAG,EAA/D,CAEA,MAAOpB,CAAAA,KAAK,CACTsB,IADI,CAEH,kEAFG,EAIJC,IAJI,CAIC,SAACC,GAAD,CAAS,CACb,GAAIA,GAAG,CAACZ,MAAJ,GAAe,GAAnB,CAAwB,CACtBX,MAAM,CAACwB,GAAP,CAAW,aAAX,CAA0BD,GAAG,CAAClB,OAAJ,CAAYoB,WAAtC,EACAjB,KAAK,CAACE,MAAN,CAAaL,OAAb,CAAqBqB,aAArB,CAAqCH,GAAG,CAAClB,OAAJ,CAAYoB,WAAjD,CACA,MAAO1B,CAAAA,KAAK,CAACU,eAAD,CAAZ,CACD,CACF,CAVI,CAAP,CAWD,CACD,MAAOO,CAAAA,OAAO,CAACC,MAAR,CAAeT,KAAf,CAAP,CACD,CApCH,EAuCA,cAAe,CACbD,GAAG,CAAER,KAAK,CAACQ,GADE,CAEbc,IAAI,CAAEtB,KAAK,CAACsB,IAFC,CAGbM,MAAM,CAAE5B,KAAK,CAAC4B,MAHD,CAIbC,GAAG,CAAE7B,KAAK,CAAC6B,GAJE,CAAf","sourcesContent":["import axios from \"axios\"\nimport Cookie from \"js-cookie\"\n\naxios.interceptors.request.use(\n  (response) => {\n    response.headers.common[\"Authorization\"] = Cookie.get(\"accesstoken\") + \"\"\n    return response\n  },\n  function (error) {}\n)\n\naxios.interceptors.response.use(\n  (response) => {\n    return response\n  },\n  function (error) {\n    const originalRequest = error.config\n\n    if (\n      error.response.status === 401 &&\n      originalRequest.url ===\n        \"https://hamnavazi-api.azurewebsites.net/api/Account/RefreshToken\"\n    ) {\n      window.location.href = \"/Auth/Login\"\n      return Promise.reject(error)\n    }\n\n    if (error.response.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true\n      // const refreshToken = Cookie.get(\"refreshtoken\")\n      const refreshToken =\n        \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJmNDhiOTYxOC1jZGY1LTEyNDktNTY4Ni0xYjNhMTA2NzlkYjgiLCJpc3MiOiJodHRwczovL3BvcnRhbC5xZWF0ZWNoLmNvbS8iLCJpYXQiOjE2MDI2Njg2MjksImh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd3MvMjAwOC8wNi9pZGVudGl0eS9jbGFpbXMvc2VyaWFsbnVtYmVyIjoiOTZlNTkxNWM4NzliN2VlMTU0ZjQ5Njg2NjQ5ZGQ1NzkiLCJuYmYiOjE2MDI2Njg2MjksImV4cCI6MTYwMjY5MDIyOSwiYXVkIjoiQW55In0.SVhosgAjsA3Iql7qjWUFTJ0s30pmVd3RrqikddIh004\"\n      axios.defaults.headers.common[\"refreshToken\"] = refreshToken + \"\"\n\n      return axios\n        .post(\n          \"https://hamnavazi-api.azurewebsites.net/api/Account/RefreshToken\"\n        )\n        .then((res) => {\n          if (res.status === 200) {\n            Cookie.set(\"accesstoken\", res.headers.accesstoken)\n            error.config.headers.Authorization = res.headers.accesstoken\n            return axios(originalRequest)\n          }\n        })\n    }\n    return Promise.reject(error)\n  }\n)\n\nexport default {\n  get: axios.get,\n  post: axios.post,\n  delete: axios.delete,\n  put: axios.put,\n}\n"]},"metadata":{},"sourceType":"module"}