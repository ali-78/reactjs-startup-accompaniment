{"ast":null,"code":"import axios from \"axios\";\nimport Cookie from \"js-cookie\";\naxios.interceptors.request.use(response => {\n  response.headers.common[\"Authorization\"] = Cookie.get(\"accesstoken\") + \"\";\n  return response;\n}, function (error) {});\naxios.interceptors.response.use(response => {\n  return response;\n}, function (error) {\n  const originalRequest = error.config;\n\n  if (error.response.status === 401 && originalRequest.url === \"https://hamnavazi-api.azurewebsites.net/api/Account/RefreshToken\") {\n    window.location.href = \"/Auth/Login\";\n    return Promise.reject(error);\n  }\n\n  if (error.response.status === 401 && !originalRequest._retry) {\n    originalRequest._retry = true; // const refreshToken = Cookie.get(\"refreshtoken\")\n\n    const refreshToken = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJmNDhiOTYxOC1jZGY1LTEyNDktNTY4Ni0xYjNhMTA2NzlkYjgiLCJpc3MiOiJodHRwczovL3BvcnRhbC5xZWF0ZWNoLmNvbS8iLCJpYXQiOjE2MDI2Njg2MjksImh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd3MvMjAwOC8wNi9pZGVudGl0eS9jbGFpbXMvc2VyaWFsbnVtYmVyIjoiOTZlNTkxNWM4NzliN2VlMTU0ZjQ5Njg2NjQ5ZGQ1NzkiLCJuYmYiOjE2MDI2Njg2MjksImV4cCI6MTYwMjY5MDIyOSwiYXVkIjoiQW55In0.SVhosgAjsA3Iql7qjWUFTJ0s30pmVd3RrqikddIh004\";\n    axios.defaults.headers.common[\"refreshToken\"] = refreshToken + \"\";\n    return axios.post(\"https://hamnavazi-api.azurewebsites.net/api/Account/RefreshToken\").then(res => {\n      if (res.status === 200) {\n        Cookie.set(\"accesstoken\", res.headers.accesstoken);\n        error.config.headers.Authorization = res.headers.accesstoken;\n        return axios(originalRequest);\n      }\n    });\n  }\n\n  return Promise.reject(error);\n});\nexport default {\n  get: axios.get,\n  post: axios.post,\n  delete: axios.delete,\n  put: axios.put\n};","map":{"version":3,"sources":["/home/ali/hamnavazi/my-app/src/core/api/http.api.ts"],"names":["axios","Cookie","interceptors","request","use","response","headers","common","get","error","originalRequest","config","status","url","window","location","href","Promise","reject","_retry","refreshToken","defaults","post","then","res","set","accesstoken","Authorization","delete","put"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AAEAD,KAAK,CAACE,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CACGC,QAAD,IAAc;AACZA,EAAAA,QAAQ,CAACC,OAAT,CAAiBC,MAAjB,CAAwB,eAAxB,IAA2CN,MAAM,CAACO,GAAP,CAAW,aAAX,IAA4B,EAAvE;AACA,SAAOH,QAAP;AACD,CAJH,EAKE,UAAUI,KAAV,EAAiB,CAAE,CALrB;AAQAT,KAAK,CAACE,YAAN,CAAmBG,QAAnB,CAA4BD,GAA5B,CACGC,QAAD,IAAc;AACZ,SAAOA,QAAP;AACD,CAHH,EAIE,UAAUI,KAAV,EAAiB;AACf,QAAMC,eAAe,GAAGD,KAAK,CAACE,MAA9B;;AAEA,MACEF,KAAK,CAACJ,QAAN,CAAeO,MAAf,KAA0B,GAA1B,IACAF,eAAe,CAACG,GAAhB,KACE,kEAHJ,EAIE;AACAC,IAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,aAAvB;AACA,WAAOC,OAAO,CAACC,MAAR,CAAeT,KAAf,CAAP;AACD;;AAED,MAAIA,KAAK,CAACJ,QAAN,CAAeO,MAAf,KAA0B,GAA1B,IAAiC,CAACF,eAAe,CAACS,MAAtD,EAA8D;AAC5DT,IAAAA,eAAe,CAACS,MAAhB,GAAyB,IAAzB,CAD4D,CAE5D;;AACA,UAAMC,YAAY,GAChB,kaADF;AAEApB,IAAAA,KAAK,CAACqB,QAAN,CAAef,OAAf,CAAuBC,MAAvB,CAA8B,cAA9B,IAAgDa,YAAY,GAAG,EAA/D;AAEA,WAAOpB,KAAK,CACTsB,IADI,CAEH,kEAFG,EAIJC,IAJI,CAIEC,GAAD,IAAS;AACb,UAAIA,GAAG,CAACZ,MAAJ,KAAe,GAAnB,EAAwB;AACtBX,QAAAA,MAAM,CAACwB,GAAP,CAAW,aAAX,EAA0BD,GAAG,CAAClB,OAAJ,CAAYoB,WAAtC;AACAjB,QAAAA,KAAK,CAACE,MAAN,CAAaL,OAAb,CAAqBqB,aAArB,GAAqCH,GAAG,CAAClB,OAAJ,CAAYoB,WAAjD;AACA,eAAO1B,KAAK,CAACU,eAAD,CAAZ;AACD;AACF,KAVI,CAAP;AAWD;;AACD,SAAOO,OAAO,CAACC,MAAR,CAAeT,KAAf,CAAP;AACD,CApCH;AAuCA,eAAe;AACbD,EAAAA,GAAG,EAAER,KAAK,CAACQ,GADE;AAEbc,EAAAA,IAAI,EAAEtB,KAAK,CAACsB,IAFC;AAGbM,EAAAA,MAAM,EAAE5B,KAAK,CAAC4B,MAHD;AAIbC,EAAAA,GAAG,EAAE7B,KAAK,CAAC6B;AAJE,CAAf","sourcesContent":["import axios from \"axios\"\nimport Cookie from \"js-cookie\"\n\naxios.interceptors.request.use(\n  (response) => {\n    response.headers.common[\"Authorization\"] = Cookie.get(\"accesstoken\") + \"\"\n    return response\n  },\n  function (error) {}\n)\n\naxios.interceptors.response.use(\n  (response) => {\n    return response\n  },\n  function (error) {\n    const originalRequest = error.config\n\n    if (\n      error.response.status === 401 &&\n      originalRequest.url ===\n        \"https://hamnavazi-api.azurewebsites.net/api/Account/RefreshToken\"\n    ) {\n      window.location.href = \"/Auth/Login\"\n      return Promise.reject(error)\n    }\n\n    if (error.response.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true\n      // const refreshToken = Cookie.get(\"refreshtoken\")\n      const refreshToken =\n        \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJmNDhiOTYxOC1jZGY1LTEyNDktNTY4Ni0xYjNhMTA2NzlkYjgiLCJpc3MiOiJodHRwczovL3BvcnRhbC5xZWF0ZWNoLmNvbS8iLCJpYXQiOjE2MDI2Njg2MjksImh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd3MvMjAwOC8wNi9pZGVudGl0eS9jbGFpbXMvc2VyaWFsbnVtYmVyIjoiOTZlNTkxNWM4NzliN2VlMTU0ZjQ5Njg2NjQ5ZGQ1NzkiLCJuYmYiOjE2MDI2Njg2MjksImV4cCI6MTYwMjY5MDIyOSwiYXVkIjoiQW55In0.SVhosgAjsA3Iql7qjWUFTJ0s30pmVd3RrqikddIh004\"\n      axios.defaults.headers.common[\"refreshToken\"] = refreshToken + \"\"\n\n      return axios\n        .post(\n          \"https://hamnavazi-api.azurewebsites.net/api/Account/RefreshToken\"\n        )\n        .then((res) => {\n          if (res.status === 200) {\n            Cookie.set(\"accesstoken\", res.headers.accesstoken)\n            error.config.headers.Authorization = res.headers.accesstoken\n            return axios(originalRequest)\n          }\n        })\n    }\n    return Promise.reject(error)\n  }\n)\n\nexport default {\n  get: axios.get,\n  post: axios.post,\n  delete: axios.delete,\n  put: axios.put,\n}\n"]},"metadata":{},"sourceType":"module"}